package com.healthcare.tests;

import com.healthcare.pages.LoginPage;
import com.healthcare.utils.ConfigReader;
import com.healthcare.utils.DriverFactory;

import java.time.Duration;

import org.openqa.selenium.By;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Assert;
import org.testng.annotations.*;

public class LoginTests {
    private LoginPage loginPage;

    @BeforeClass
    public void beforeClass() {
        ConfigReader.loadConfig();
    }

    @BeforeMethod
    public void setup() {
        DriverFactory.initDriver(ConfigReader.get("browser"));
        DriverFactory.getDriver().get(ConfigReader.get("loginUrl")); // add loginUrl in config.properties
        loginPage = new LoginPage();
    }

    @Teso
   
    public void verifyLogin() {
        loginPage.login(ConfigReader.get("username"), ConfigReader.get("password"));

        WebDriverWait wait = new WebDriverWait(DriverFactory.getDriver(), Duration.ofSeconds(30));
        boolean logoutVisible = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id("logoutButtonId"))).isDisplayed();

        Assert.assertTrue(logoutVisible, "Logout button should be visible after login");
        System.out.println("Login successful, logout button visible!");
    }

    @AfterMethod
    public void tearDown() {
        DriverFactory.quitDriver();
    }
}
