package com.healthcare.stepdefinitions;

import com.healthcare.pages.ServicesPage;
import com.healthcare.utils.ConfigReader;
import com.healthcare.utils.DriverFactory;
import io.cucumber.java.en.*;
import org.openqa.selenium.WebDriver;

public class ServicesSteps {
    private WebDriver driver = DriverFactory.getDriver();
    private ServicesPage servicesPage = new ServicesPage();

    @Given("user is on the home page")
    public void user_is_on_the_home_page() {
        driver.get(ConfigReader.getProperty("baseUrl"));
    }

    @When("user clicks on the Services menu")
    public void user_clicks_on_the_services_menu() throws InterruptedException {
        Thread.sleep(2000);
        servicesPage.openServicesDropdown();
    }

    @Then("user should see the list of services")
    public void user_should_see_the_list_of_services() throws InterruptedException {
        Thread.sleep(2000);
        servicesPage.getAllServiceLinks().forEach(link ->
            System.out.println("Service: " + link.getText())
        );
    }

    @Then("user should navigate to each service page")
    public void user_should_navigate_to_each_service_page() throws InterruptedException {
        servicesPage.getAllServiceLinks().forEach(link -> {
            String serviceName = link.getText();
            System.out.println("Visiting Service: " + serviceName);
            link.click();
            try { Thread.sleep(2000); } catch (InterruptedException e) {}
            System.out.println("Page Title: " + driver.getTitle());
            driver.navigate().back();
            try { Thread.sleep(2000); } catch (InterruptedException e) {}
            servicesPage.openServicesDropdown(); // reopen dropdown after going back
        });
    }

}
